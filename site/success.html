<!doctype html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Payment Confirmed</title>
<style>body{font-family:system-ui;background:#0d1530;color:#eef;padding:24px}code,textarea{width:100%;background:#070d1e;color:#cfe;border:1px solid #2e4f9f;border-radius:8px;padding:10px}.btn{display:inline-block;margin-top:10px;padding:9px 12px;background:#0a5d7f;color:#fff;border-radius:8px;text-decoration:none;border:0}</style>
</head><body>
<h1>Payment confirmed</h1>
<p>Your checkout is complete. Fetch your grant token, then redeem it in your local node endpoint <code>/api/redeem_grant</code>.</p>
<p><button class="btn" id="load">Load grant token</button></p>
<textarea id="token" rows="8" placeholder="Grant token will appear here"></textarea>
<script>
const params = new URLSearchParams(location.search);
const sid = params.get('session_id');
const out = document.getElementById('token');
document.getElementById('load').onclick = async () => {
  if (!sid) { out.value = 'Missing session_id in URL.'; return; }
  const res = await fetch(`/.netlify/functions/get_grant_token?session_id=${encodeURIComponent(sid)}`);
  const data = await res.json();
  out.value = data.grant_token || JSON.stringify(data, null, 2);
};
</script>
</body></html>
